# ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏±‡∏ô Docker Compose

## ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô

1. **‡πÄ‡∏õ‡∏¥‡∏î Terminal** ‡πÅ‡∏•‡∏∞‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå docker-compose.yml:

   ```bash
   cd /Users/nevelopdevper/iDev/ABC
   ```

2. **‡∏£‡∏±‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î**:

   ```bash
   docker compose up
   ```

   ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏±‡∏ô‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î detached (‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á):

   ```bash
   docker compose up -d
   ```

3. **‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô** (‡∏≠‡∏≤‡∏à‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ build images ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å)

## ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö

1. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö Backend API**:
   - ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏õ‡∏ó‡∏µ‡πà: http://localhost:5000/swagger
   - ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ curl: `curl http://localhost:5000/weatherforecast`

2. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö Frontend**:
   - ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏õ‡∏ó‡∏µ‡πà: http://localhost:3000

3. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•**:
   - ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ SQL Server ‡∏î‡πâ‡∏ß‡∏¢‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÄ‡∏ä‡πà‡∏ô Azure Data Studio)
   - Host: localhost
   - Port: 1433
   - User: sa
   - Password: YourStrongPassword!
   - Database: ABC

## ‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (Logs)

```bash
# ‡∏î‡∏π‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
docker-compose logs

# ‡∏î‡∏π‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞ service
docker-compose logs backend
docker-compose logs frontend
docker-compose logs db

# ‡∏î‡∏π‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏ö‡∏ö real-time
docker-compose logs -f
```

## ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå

```bash
# ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
docker-compose down

# ‡∏´‡∏¢‡∏∏‡∏î‡πÅ‡∏•‡∏∞‡∏•‡∏ö volumes (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡πÑ‡∏õ)
docker-compose down -v

# ‡∏™‡∏£‡πâ‡∏≤‡∏á build ‡πÉ‡∏´‡∏°‡πà
docker-compose build

# ‡∏£‡∏µ‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
docker-compose restart backend
```

## ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô

- ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á services ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö network settings
- ‡∏´‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏•‡∏≠‡∏á wait-for-it script ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ depends_on condition
- ‡∏ñ‡πâ‡∏≤ frontend ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ API ‡πÑ‡∏î‡πâ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤ NEXT_PUBLIC_API_URL

‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏´‡∏ô‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö?

Project Structure ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:
ABC/
‚îú‚îÄ‚îÄ .env.development        # Local dev secrets
‚îú‚îÄ‚îÄ .env.production        # Production secrets
‚îú‚îÄ‚îÄ docker-compose.yml     # Production
‚îú‚îÄ‚îÄ docker-compose.dev.yml # Development (‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô)
‚îú‚îÄ‚îÄ Backend/
‚îÇ   ‚îî‚îÄ‚îÄ src/API/
‚îÇ       ‚îú‚îÄ‚îÄ appsettings.Development.json
‚îÇ       ‚îî‚îÄ‚îÄ appsettings.Production.json
‚îî‚îÄ‚îÄ scripts/
    ‚îú‚îÄ‚îÄ dev.sh            # dotnet watch run
    ‚îú‚îÄ‚îÄ build.sh          # docker build
    ‚îî‚îÄ‚îÄ deploy.sh         # docker compose up

Migration
# ABC Project

## Database Management

### Development Environment

#### Method 1: dotnet CLI (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)
```bash
cd Backend/src/API

# ‡∏™‡∏£‡πâ‡∏≤‡∏á migration
dotnet ef migrations add MigrationName

# ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó database
dotnet ef database update
```

#### Method 2: Automatic Migration (‡∏£‡∏∞‡∏ß‡∏±‡∏á!)
```csharp
// Program.cs - ‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Development ‡πÅ‡∏•‡∏∞ Database ‡πÉ‡∏´‡∏°‡πà
if (app.Environment.IsDevelopment())
{
    context.Database.Migrate(); // ‡∏≠‡∏≤‡∏à error ‡∏ñ‡πâ‡∏≤ table ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
}
```

### Production Environment

#### ‚ö†Ô∏è ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ Automatic Migration
```bash
# ‡∏™‡∏£‡πâ‡∏≤‡∏á SQL script
dotnet ef migrations script --output migration.sql

# Review script ‡∏Å‡πà‡∏≠‡∏ô
cat migration.sql

# ‡∏£‡∏±‡∏ô script ‡πÉ‡∏ô Production Database manually
psql -h your-host -U username -d database -f migration.sql
```

### ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Table Already Exists

#### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: Empty Migration
```bash
dotnet ef migrations add SyncExistingTables
# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡πâ Up() ‡πÅ‡∏•‡∏∞ Down() ‡∏ß‡πà‡∏≤‡∏á
dotnet ef database update
```

#### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: Manual Sync
```sql
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20241225000000_InitialCreate', '8.0.0');
```

## Development Workflow

### ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥:
```bash
# Terminal 1: Backend Development
cd Backend/src/API
dotnet watch run

# Terminal 2: Database Operations
cd Backend/src/API
dotnet ef migrations add NewFeature
dotnet ef database update

# Terminal 3: Frontend Development
cd Frontend/abc-client
npm run dev
```

### ‡∏Å‡∏≤‡∏£ Deploy:
```bash
# 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á Migration Script
dotnet ef migrations script --output migration.sql

# 2. Deploy Application
docker compose up -d

# 3. ‡∏£‡∏±‡∏ô Migration Script manually
# (‡∏ú‡πà‡∏≤‡∏ô Supabase Dashboard ‡∏´‡∏£‡∏∑‡∏≠ CLI)
```

## ‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô

- **‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ automatic migration ‡πÉ‡∏ô Production**
- **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö migration script ‡∏Å‡πà‡∏≠‡∏ô deploy**
- **Backup database ‡∏Å‡πà‡∏≠‡∏ô migration ‡πÄ‡∏™‡∏°‡∏≠**
- **Test migration ‡πÉ‡∏ô staging environment ‡∏Å‡πà‡∏≠‡∏ô**


üí° Tips:
‡πÅ‡∏¢‡∏Å Frontend/Backend - deploy ‡∏Ñ‡∏ô‡∏•‡∏∞ platform
‡πÉ‡∏ä‡πâ Supabase - database ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏á‡∏ß‡∏•
Setup CI/CD - auto-deploy ‡πÄ‡∏°‡∏∑‡πà‡∏≠ push
Monitor Usage - ‡∏î‡∏π billing ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô free tier
üéØ ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:
Railway: Backend API
Vercel: Next.js Frontend
Supabase: Database (‡πÉ‡∏ä‡πâ‡πÄ‡∏î‡∏¥‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ)

# ‡∏™‡∏£‡πâ‡∏≤‡∏á migration ‡πÉ‡∏ô Infrastructure
dotnet ef migrations add InitialCreate \
  --project ../Infrastructure \
  --startup-project . \
  --context ApplicationDbContext \
  --output-dir Data/Migrations

# ‡∏£‡∏±‡∏ô migration
dotnet ef database update --project ../Infrastructure --startup-project . --context ApplicationDbContext

